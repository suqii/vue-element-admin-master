(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53dcf724"],{"12da":function(e,t,r){"use strict";r("1bb1")},"1bb1":function(e,t,r){},2423:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"i",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"g",(function(){return o})),r.d(t,"h",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"f",(function(){return m}));var a=r("b775");function n(e){return Object(a["a"])({url:"/vue-element-admin/article/list",method:"get",params:e})}function i(e){return Object(a["a"])({url:"/vue-element-admin/user/userList",method:"get",params:e})}function s(e){return Object(a["a"])({url:"/getuserinfo",method:"post",params:{user_id:e}})}function o(e){return Object(a["a"])({url:"/vue-element-admin/user/userDelete",method:"post",params:{user_id:e}})}function l(e,t,r,n,i){return Object(a["a"])({url:"/vue-element-admin/user/userEdit",method:"post",params:{user_id:e,job:t,path:r,sex:n,email:i}})}function u(e){return Object(a["a"])({url:"/vue-element-admin/article/detail",method:"get",params:{id:e}})}function c(e){return Object(a["a"])({url:"/vue-element-admin/article/pv",method:"get",params:{pv:e}})}function d(e){return Object(a["a"])({url:"/vue-element-admin/article/create",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/vue-element-admin/article/update",method:"post",data:e})}},"7d9e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:15}},[r("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getUserList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")]),r("el-button",{attrs:{type:"danger"},on:{click:e.deleteSettleUsers}},[e._v("删除选中")])],1)],1),r("el-table",{attrs:{data:e.userList.slice(e.sliceNumStart,e.sliceNumEnd),border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{prop:"id",label:"序号"}}),r("el-table-column",{attrs:{label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("div",{style:"height:60px; width:60px; border:1px gray solid;border-radius: 50%;background: url("+(null==e.row.userpic?e.row.userpic:e.row.userpic.replace(/\\/g,"/"))+") no-repeat; background-size:cover;"})]}}])}),r("el-table-column",{attrs:{label:"用户名",prop:"username"}}),r("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),r("el-table-column",{attrs:{label:"电话",prop:"phone"}}),r("el-table-column",{attrs:{label:"注册时间",prop:"create_time"}}),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.userStateChanged(t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",round:""},on:{click:function(r){return e.showEditDialog(t.row.id)}}}),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",round:""},on:{click:function(r){return e.removeUserById(t.row.id)}}}),r("el-tooltip",{attrs:{effect:"dark",content:"分配角色",placement:"top-start",enterable:!1}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini",round:""}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"修改用户",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"70px"}},[r("el-form-item",{staticClass:"imageUrl",attrs:{label:""}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://api.test2.com/api/v1/vue-element-admin/user/userHeadEdit?user_id=18","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1),r("el-form-item",{attrs:{label:"工作",prop:"userinfo.job"}},[r("el-input",{model:{value:e.editForm.userinfo.job,callback:function(t){e.$set(e.editForm.userinfo,"job",t)},expression:"editForm.userinfo.job"}})],1),r("el-form-item",{attrs:{label:"性别"}},[r("el-select",{attrs:{placeholder:"性别"},model:{value:e.editForm.userinfo.sex,callback:function(t){e.$set(e.editForm.userinfo,"sex",t)},expression:"editForm.userinfo.sex"}},[r("el-option",{attrs:{label:"男",value:"1"}}),r("el-option",{attrs:{label:"女",value:"2"}})],1)],1),r("el-form-item",{attrs:{label:"地址"}},[r("el-cascader",{attrs:{size:"large",options:e.options},on:{change:e.handleAreaChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUserInfo(e.editForm.id)}}},[e._v("确 定")])],1)],1)],1)},n=[],i=r("e9ff"),s=(r("e186"),r("08ba"),r("e18c"),r("1c2e"),r("96db"),r("af86"),r("f1a9"),r("c370"),r("b4fb"),r("2423")),o=r("2e3f"),l={data:function(){var e=function(e,t,r){var a=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;if(a.test(t))return r();r(new Error("请输入合法的邮箱"))},t=function(e,t,r){var a=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;if(a.test(t))return r();r(new Error("请输入合法手机号"))};return{sliceNumStart:0,sliceNumEnd:10,pageSize:10,queryInfo:{query:"",pagenum:1,pagesize:2},imageUrl:"",options:o["regionDataPlus"],selectedOptions:[],settleUserList:[],userList:[],total:0,addDialogVisible:!1,addForm:{id:"",username:"",password:"",email:"",phone:""},addFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"用户名的长度在3-10个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"密码的长度在6-15个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],phone:[{required:!0,message:"请输入手机",trigger:"blur"},{validator:t,trigger:"blur"}]},editDialogVisible:!1,editForm:{email:"",password:"",phone:"",userinfo:{job:"",sex:"",path:""}},editFormRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object(s["i"])().then((function(t){e.userList=t.data.list.reverse(),e.userList.forEach((function(t){t.create_time&&(t.create_time=e.transitionTime(t.create_time))})),e.total=t.data.list.length}));case 1:case"end":return t.stop()}}),t)})))()},transitionTime:function(e){var t;t=13!=e.toString().length?1e3*e:e;var r=new Date(t),a=-r.getTimezoneOffset()/60;a<0?(a=Math.abs(a)+8,t+=60*a*60*1e3):(a-=8,t-=60*a*60*1e3);var n=new Date(t),i=n.getFullYear(),s=n.getMonth()+1,o=n.getDate(),l=i+"-";if(s<10&&(l+="0"),l+=s+"-",o<10&&(l+="0"),l+=o+" ",13==e.toString().length){var u=n.getHours(),c=n.getMinutes(),d=n.getSeconds();u<10&&(l+="0"),l+=u+":",c<10&&(l+="0"),l+=c+":",d<10&&(l+="0"),l+=d}return l},handleAreaChange:function(e){if(null!=e[1]&&null!=e[2]){var t=o["CodeToText"][e[0]]+o["CodeToText"][e[1]]+o["CodeToText"][e[2]];this.addressid=e[2]}else null!=e[1]?(t=o["CodeToText"][e[0]]+o["CodeToText"][e[1]],this.addressid=e[1]):(t=o["CodeToText"][e[0]],this.addressid=e[0]);this.editForm.userinfo.path=t},deleteSettleUsers:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("此操作将永久删除已选中用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=t.sent,"confirm"===r){t.next=5;break}return t.abrupt("return",e.$message.info("已取消删除"));case 5:e.settleUserList.forEach((function(t){Object(s["g"])(t).then((function(r){2e4!==r.code&&e.$message.error("删除用户"+t+"失败")}))})),e.$message.success("删除成功"),e.getUserList();case 8:case"end":return t.stop()}}),t)})))()},handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},handleSelectionChange:function(e){var t=this;this.settleUserList=[],e.forEach((function(e){t.settleUserList.push(e.id)}))},handleSizeChange:function(e){this.pageSize=e,this.sliceNumStart=0,this.sliceNumEnd=e},handleCurrentChange:function(e){this.sliceNumStart=this.pageSize*(e-1),this.sliceNumEnd=this.pageSize*e},userStateChanged:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.put("users/".concat(e.id,"/state/").concat(e.mg_state));case 2:if(a=r.sent,n=a.data,200===n.meta.status){r.next=6;break}return r.abrupt("return",t.$message.error(n.meta.msg));case 6:t.$message.success(n.meta.msg);case 7:case"end":return r.stop()}}),r)})))()},addDialogClosed:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.addFormRef.resetFields();case 1:case"end":return t.stop()}}),t)})))()},addUser:function(){var e=this;this.$refs.addFormRef.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(" 添加用户 "),r){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.$http.post("users",e.addForm);case 5:if(a=t.sent,n=a.data,201===n.meta.status){t.next=9;break}return t.abrupt("return",e.$message.error(n.meta.msg));case 9:e.$message.success(n.meta.msg),e.addDialogVisible=!1,e.getUserList();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},showEditDialog:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:console.log(t.selectedOptions),Object(s["e"])(e).then((function(e){t.editForm.id=e.data.id,t.imageUrl=e.data.userpic,t.editForm.email=e.data.email,t.editForm.username=e.data.username,t.editForm.phone=e.data.phone,t.editForm.userinfo.job=e.data.userinfo.job,1!=e.data.userinfo.sex?t.editForm.userinfo.sex="女":t.editForm.userinfo.sex="男",t.editForm.userinfo.path=e.data.userinfo.path})),t.editDialogVisible=!0;case 3:case"end":return r.stop()}}),r)})))()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},editUserInfo:function(e){var t=this;1!=this.editForm.userinfo.sex?this.editForm.userinfo.sex=2:this.editForm.userinfo.sex=1,this.editForm.userinfo.job||(this.editForm.userinfo.job=""),this.editForm.userinfo.path||(this.editForm.userinfo.path=""),this.editForm.email||(this.editForm.email=""),Object(s["h"])(e,this.editForm.userinfo.job,this.editForm.userinfo.path,this.editForm.userinfo.sex,this.editForm.email).then((function(e){if(2e4!==e.code)return t.$message.error(t.meta.msg);t.editDialogVisible=!1,t.getUserList(),t.$message.success("更新成功")}))},removeUserById:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(a=r.sent,"confirm"===a){r.next=5;break}return r.abrupt("return",t.$message.info("已取消删除"));case 5:Object(s["g"])(e).then((function(e){2e4!==e.code&&t.$message.error("删除失败"),t.$message.success("删除成功"),t.getUserList()}));case 6:case"end":return r.stop()}}),r)})))()}}},u=l,c=(r("12da"),r("cba8")),d=Object(c["a"])(u,a,n,!1,null,"c94a7310",null);t["default"]=d.exports}}]);