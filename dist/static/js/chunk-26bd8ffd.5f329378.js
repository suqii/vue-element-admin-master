(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26bd8ffd"],{3891:function(e,t,r){"use strict";r("faf5")},"7d9e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:15}},[r("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getUserList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),r("el-col",{attrs:{span:8}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")]),r("el-button",{attrs:{type:"danger"},on:{click:e.deleteSettleUsers}},[e._v("删除选中")])],1)],1),r("el-table",{attrs:{data:e.userList.slice(e.sliceNumStart,e.sliceNumEnd),border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{prop:"id",label:"序号"}}),r("el-table-column",{attrs:{label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("div",{style:"height:60px; width:60px; border:1px gray solid;border-radius: 50%;background: url("+(null==e.row.userpic?e.row.userpic:e.row.userpic.replace(/\\/g,"/"))+") no-repeat; background-size:cover;"})]}}])}),r("el-table-column",{attrs:{label:"用户名",prop:"username"}}),r("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),r("el-table-column",{attrs:{label:"电话",prop:"phone"}}),r("el-table-column",{attrs:{label:"注册时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("parseTime")(t.row.create_time,"{y}-{m}-{d} {h}:{i}"))+" ")]}}])}),r("el-table-column",{attrs:{label:"禁用"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.userStateChanged(t.row)}},model:{value:t.row.status,callback:function(r){e.$set(t.row,"status",r)},expression:"scope.row.status"}})]}}])}),r("el-table-column",{attrs:{label:"管理员"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.adminSet(t.row)}},model:{value:t.row.admin,callback:function(r){e.$set(t.row,"admin",r)},expression:"scope.row.admin"}})]}}])}),r("el-table-column",{attrs:{label:"详情"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("router-link",{staticClass:"link-type",attrs:{to:"/userList/userProfile/"+a.id}},[e._v(" 详情 ")])]}}])}),r("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"dark",content:"账号信息修改",placement:"top-start",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",round:""},on:{click:function(r){return e.showEditDialog(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"账号删除",placement:"top-start",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",round:""},on:{click:function(r){return e.removeUserById(t.row.id)}}})],1),r("el-tooltip",{attrs:{effect:"dark",content:"密码重置",placement:"top-start",enterable:!1}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-refresh",size:"mini",round:""},on:{click:function(r){return e.restPassword(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{model:{value:e.addForm.phone,callback:function(t){e.$set(e.addForm,"phone",t)},expression:"addForm.phone"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"修改用户",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"70px"}},[r("el-form-item",{staticClass:"imageUrl",attrs:{label:""}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://api.test2.com/api/v1/vue-element-admin/user/userHeadEdit?user_id=18","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"phone"}},[r("el-input",{model:{value:e.editForm.phone,callback:function(t){e.$set(e.editForm,"phone",t)},expression:"editForm.phone"}})],1),r("el-form-item",{attrs:{label:"签名",prop:"userinfo.job"}},[r("el-input",{model:{value:e.editForm.userinfo.job,callback:function(t){e.$set(e.editForm.userinfo,"job",t)},expression:"editForm.userinfo.job"}})],1),r("el-form-item",{attrs:{label:"性别"}},[r("el-select",{attrs:{placeholder:"性别"},model:{value:e.editForm.userinfo.sex,callback:function(t){e.$set(e.editForm.userinfo,"sex",t)},expression:"editForm.userinfo.sex"}},[r("el-option",{attrs:{label:"男",value:"1"}}),r("el-option",{attrs:{label:"女",value:"2"}})],1)],1),r("el-form-item",{attrs:{label:"地址"}},[r("el-cascader",{attrs:{size:"large",options:e.options},on:{change:e.handleAreaChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUserInfo(e.editForm.id)}}},[e._v("确 定")])],1)],1)],1)},s=[],n=r("e9ff"),i=(r("e186"),r("08ba"),r("e18c"),r("96db"),r("af86"),r("f1a9"),r("c370"),r("c24f")),o=r("2e3f"),l={data:function(){var e=function(e,t,r){var a=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;if(a.test(t))return r();r(new Error("请输入合法的邮箱"))},t=function(e,t,r){var a=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;if(a.test(t))return r();r(new Error("请输入合法手机号"))};return{sliceNumStart:0,sliceNumEnd:10,pageSize:10,queryInfo:{query:"",pagenum:1,pagesize:2},imageUrl:"",options:o["regionDataPlus"],selectedOptions:[],settleUserList:[],userList:[],total:0,addDialogVisible:!1,addForm:{id:"",username:"",password:"",email:"",phone:""},addFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"用户名的长度在3-10个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"密码的长度在6-15个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],phone:[{required:!0,message:"请输入手机",trigger:"blur"},{validator:t,trigger:"blur"}]},editDialogVisible:!1,editForm:{email:"",password:"",phone:"",userinfo:{job:"",sex:"",path:""}},editFormRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object(i["o"])().then((function(t){e.userList=t.data.list.reverse(),e.userList.forEach((function(e){e.status?e.status=!1:e.status=!0,e.admin?e.admin=!0:e.admin=!1})),e.total=t.data.list.length}));case 1:case"end":return t.stop()}}),t)})))()},handleAreaChange:function(e){if(null!=e[1]&&null!=e[2]){var t=o["CodeToText"][e[0]]+o["CodeToText"][e[1]]+o["CodeToText"][e[2]];this.addressid=e[2]}else null!=e[1]?(t=o["CodeToText"][e[0]]+o["CodeToText"][e[1]],this.addressid=e[1]):(t=o["CodeToText"][e[0]],this.addressid=e[0]);this.editForm.userinfo.path=t},deleteSettleUsers:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("此操作将永久删除已选中用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=t.sent,"confirm"===r){t.next=5;break}return t.abrupt("return",e.$message.info("已取消删除"));case 5:e.settleUserList.forEach((function(t){Object(i["m"])(t).then((function(r){2e4!==r.code&&e.$message.error("删除用户"+t+"失败")}))})),e.$message.success("删除成功"),e.getUserList();case 8:case"end":return t.stop()}}),t)})))()},handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},handleSelectionChange:function(e){var t=this;this.settleUserList=[],e.forEach((function(e){t.settleUserList.push(e.id)}))},handleSizeChange:function(e){this.pageSize=e,this.sliceNumStart=0,this.sliceNumEnd=e},handleCurrentChange:function(e){this.sliceNumStart=this.pageSize*(e-1),this.sliceNumEnd=this.pageSize*e},userStateChanged:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.status?Object(i["d"])(e.id).then((function(r){2e4!==r.code?t.$message.error("禁用用户"+e.id+"失败"):t.$message({message:"成功禁用",type:"warning"}),console.log(r)})):Object(i["c"])(e.id).then((function(r){2e4!==r.code?t.$message.error("解除禁用用户"+e.id+"失败"):t.$message({message:"成功解除禁用",type:"success"}),console.log(r)}));case 1:case"end":return r.stop()}}),r)})))()},adminSet:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.admin?Object(i["b"])(e.id).then((function(r){2e4!==r.code?t.$message.error("设置管理员身份"+e.id+"失败"):t.$message({message:"成功将此用户设置为管理员",type:"warning"}),console.log(r)})):Object(i["a"])(e.id).then((function(r){2e4!==r.code?t.$message.error("解除管理员身份"+e.id+"失败"):t.$message({message:"成功解除该管理员身份",type:"success"}),console.log(r)}));case 1:case"end":return r.stop()}}),r)})))()},addDialogClosed:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.addFormRef.resetFields();case 1:case"end":return t.stop()}}),t)})))()},addUser:function(){var e=this;this.$refs.addFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(" 添加用户 "),r){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.$http.post("users",e.addForm);case 5:if(a=t.sent,s=a.data,201===s.meta.status){t.next=9;break}return t.abrupt("return",e.$message.error(s.meta.msg));case 9:e.$message.success(s.meta.msg),e.addDialogVisible=!1,e.getUserList();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},restPassword:function(e){var t=this;this.$confirm("确定要重置该账号吗？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["j"])(e).then((function(r){2e4!==r.code?t.$message.error("重置用户"+e+"密码失败"):t.$message({message:"密码重置成功，当前密码为123456",type:"success"})}))})).catch((function(){}))},showEditDialog:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:console.log(t.selectedOptions),Object(i["f"])(e).then((function(e){t.editForm.id=e.data.id,t.imageUrl=e.data.userpic,t.editForm.email=e.data.email,t.editForm.username=e.data.username,t.editForm.phone=e.data.phone,t.editForm.userinfo.job=e.data.userinfo.job,1!=e.data.userinfo.sex?t.editForm.userinfo.sex="女":t.editForm.userinfo.sex="男",t.editForm.userinfo.path=e.data.userinfo.path})),t.editDialogVisible=!0;case 3:case"end":return r.stop()}}),r)})))()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},editUserInfo:function(e){var t=this;1!=this.editForm.userinfo.sex?this.editForm.userinfo.sex=2:this.editForm.userinfo.sex=1,this.editForm.userinfo.job||(this.editForm.userinfo.job=""),this.editForm.userinfo.path||(this.editForm.userinfo.path=""),this.editForm.email||(this.editForm.email=""),Object(i["n"])(e,this.editForm.userinfo.job,this.editForm.userinfo.path,this.editForm.userinfo.sex,this.editForm.email).then((function(e){if(2e4!==e.code)return t.$message.error(t.meta.msg);t.editDialogVisible=!1,t.getUserList(),t.$message.success("更新成功")}))},removeUserById:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(a=r.sent,"confirm"===a){r.next=5;break}return r.abrupt("return",t.$message.info("已取消删除"));case 5:Object(i["m"])(e).then((function(e){2e4!==e.code&&t.$message.error("删除失败"),t.$message.success("删除成功"),t.getUserList()}));case 6:case"end":return r.stop()}}),r)})))()}}},u=l,c=(r("3891"),r("cba8")),d=Object(c["a"])(u,a,s,!1,null,"36cc02f9",null);t["default"]=d.exports},faf5:function(e,t,r){}}]);